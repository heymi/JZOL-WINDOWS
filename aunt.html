<html>
<header>
    <script src="js/allBiz.js"></script>
    <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">
    <link href="js/bootgrid/jquery.bootgrid.css" rel="stylesheet"/>
    <script src="js/bootstrap-datetimepicker.js"></script>
    <script src="js/bootgrid/jquery.bootgrid.js"></script>
    <script src="js/bootgrid/jquery.bootgrid.fa.js"></script>
    <script src="js/paramMap.js"></script>
</header>
<body>

<div class="container" style="background-color: #FFF"><!-- 右侧开始 -->
    <div class="content-wrapper">

        <!-- 面包屑导航样式开始 -->
        <div class="content-header-inner clearfix">
            <div class="bread-nav float-left">
                <ol class="breadcrumb">
                    <li><a href="aunt.html">阿姨管理</a></li>
                    <li class="active"><strong>全部阿姨</strong></li>
                </ol>
            </div>
        </div>
        <div class="tab-content">

            <div class="normal-table">
                <!-- 内容表格开始 -->
                <table id="dataGrid" class="table table-condensed table-hover table-striped" data-selection="true"
                       data-multi-select="true" data-row-select="true" data-keep-selection="true">
                    <thead>
                    <tr>
                        <th data-column-id="id" data-identifier="true" data-width="0px"></th>
                        <th data-column-id="name" data-order="asc" data-align="center"
                            data-header-align="center" data-width="100px">姓名
                        </th>
                        <th data-column-id="service_range" class="sort-th" data-width="150px" data-align="left"
                            headerAlign="center">工种
                        </th>
                        <th data-column-id="status" data-width="80px">状态</th>
                        <th data-column-id="phone" class="name-th" data-width="120px">联系电话</th>
                        <th data-column-id="sex">性别</th>
                        <th data-column-id="native_prov">籍贯</th>
                        <th data-column-id="qualification">学历</th>
                        <!--<th data-column-id="update_time">更新时间</th>-->
                        <th data-column-id="operations">操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <div style="display:inline">
                    <button type="button" class="btn-grey-danger" style="margin:20px 0;" data-toggle="modal"
                            data-target=".modal-del">删除
                    </button>
                </div>
            </div>
            <!-- 内容表格结束 -->
        </div>
        <div class="modal fade modal-del" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
             aria-hidden="true" id="confirmDeleteModal">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">删除订单？</h4>
                    </div>
                    <div class="modal-body">
                        您确定删除当前选择的订单？
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="button" class="btn btn-primary" id="confirmDelete">删除</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 面包屑导航样式结束 -->


    </div>
    <!-- end tab-centent -->

</div>
<!-- end shop -->
</div>
</div>
</section>

<script>
    $(function () {
                function init() {
                    $("#dataGrid").bootgrid({
                                ajax: true,
//                                ajaxSettings : {
//                                    method: "POST",
//                                    dataType : 'json'
//                                },
//                post: function ()
//                {
//                    /* To accumulate custom parameter with the request object */
//                    return {
//                        id: "b0df282a-0d67-40e5-8558-c9e93b7befed"
//                    };
//                },
                                url: "http://api.jiazhengol.com/employee/list",
                                responseHandler: function (res) {
                                    if(res.code === -1){
                                        $.scojs_message('登录失效，请退出后请重新登录！', $.scojs_message.TYPE_ERROR);
                                      }
                                    var retResult = {};
                                    retResult["rows"] = res.data.list;
                                    retResult["rowCount"] = res.data.list.length;
                                    retResult["total"] = res.data.pager.count;
                                    retResult["current"] = parseInt(res.data.pager.page);
                                    return retResult;
                                },
                                formatters: {
                                    "status": function (column, row) {
                                        return paramMap.status[row.status]
                                    },
                                    "sex": function (column, row) {
                                        return paramMap.sex[row.sex]
                                    },
                                    "qualification": function (column, row) {
                                        return paramMap.qualification[row.qualification]
                                    },
                                    "service_range": function (column, row) {
                                        return paramMap.getCodeValue('service_range', row.service_range)
                                    },
                                    "operations": function (column, row) {
                                        return "<button class=\"btn-green-small\"  onClick=\"location.href='aunt-resume.html?employeeId=" + row.id + "'\">简历</button>";
                                    },
                                    "update_time" : function (column, row) {
                                        return getLocalTime(row.update_time)
                                    },
                                    "native_prov": function(column, row){
                                        return $.province_city_area(row.native_prov);
                                    }
                                },
                                rowCount: [10, 12, 18],
                                labels: {
                                    infos: "",
                                    search: "搜索阿姨",
                                    noResults: '没有记录'
                                },
                                padding: 100,
                                templates: {
                                    header: "<div id=\"{{ctx.id}}\" class=\"{{css.header}} shopGridHeader\">" +
                                    "<div class=\"row\">" +
                                    "<div class=\"col-sm-12 actionBar shopActionBar\">" +
                                    "<button type=\"button\" class=\"btn-blue mgl7 fr\" onClick=\"location.href='add-aunt.html'\">新增阿姨</button>" +
                                    "<p class=\"{{css.search}}\"></p>" +
//                    "<p class=\"{{css.actions}}\"></p>" +
                                    "</div>" +
                                    "</div>" +
                                    "</div>",
                                    search: ""
                                },
                                css: {
                                    search: "shopSearchField search"
//                    actions : "shopActionField"
                                }
                            }
                    )
                }

                init();

                $("#confirmDelete").on("click", function () {
                    var removdeIdsArr = $("#dataGrid").bootgrid("getSelectedRows");

                    var removedIdsStr = '';
                    if (!removdeIdsArr || removdeIdsArr.length == 0) {
                        return;
                    }
                    removedIdsStr = removdeIdsArr.join(',');
                    $.ajax({
                        url: 'http://api.jiazhengol.com/employeeShop/del',
                        type: 'POST',
                        data: {employee_id : removedIdsStr},
                        success: function (ret) {
                            $('#confirmDeleteModal').modal('hide');
                            $("#dataGrid").bootgrid("remove");
                        },
                        error: function (ret) {
                            $('#confirmDeleteModal').modal('hide');
                            alert('内部错误')
                        }
                    })

                });
            }
    )
    ;
</script>

</body>
<script type="text/javascript">
    jQuery(document).ready(function () {
        $(".button-slide-menu").on("click", function () {
            $(".slide-menu").toggleClass("slide-menu-show");
            $(".fog-hover").toggleClass("fog");
        });
        $(".fog-hover").on("click", function () {
            $(".slide-menu").toggleClass("slide-menu-show");
            $(".fog-hover").toggleClass("fog");
        });
    });
    $('#myTab li:first').tab('show') // Select first tab

</script>
</html>

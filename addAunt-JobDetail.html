<html>
<header>
    <script src="js/allBiz.js"></script>
    <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">
    <script src="js/bootstrap-datetimepicker.js"></script>
    <script src="js/utils/provinceCity.js"></script>
    <script src="js/commonUtils.js"></script>
</header>
<body>

<script>
    var auntExists = false;
    var isUpdate = getQueryString("isUpdate");
    $(function () {
        var employeeId = getQueryString('employeeId');
        if(employeeId) {
            auntExists = true;
            auntId = employeeId;
            var paramData = {employee_id: employeeId};

            $.ajax({
                url: 'http://test.fuhui.com/employee/detail',
                type: 'POST',
                data: paramData,
                success: function (ret) {
                    var retObj = JSON.parse(ret);

                    //基本信息
                    $("#identity").val(retObj.data.static.identity);
                    $("#name").val(retObj.data.static.name);
                    $("#sex input[value=" + retObj.data.static.sex + "]").prop('checked', true);
                    $("#qualification input[value=" + retObj.data.static.qualification + "]").prop('checked', true);
                    $("#phone").val(retObj.data.static.phone);
                    $("#age").val(retObj.data.static.age);
                    $("#nationality").val(retObj.data.static.nationality);
                    $("#stature").val(retObj.data.static.stature);
                    $("#body").val(retObj.data.static.body);
                    $("#identity").val(retObj.data.static.identity);
                    $("#family").val(retObj.data.static.family);
                    $("#content").val(retObj.data.static.content);
                    $("#addr").val(retObj.data.static.addr);

                    $('#expected_salary').val(retObj.data.static.expect_salary)
                    $('#daily_salary').val(retObj.data.static.daily_salary)

                    //工作信息
                    setMultiSelectValue('service_range', retObj.data.dynamic.service_range)
                    setMultiSelectValue('status', retObj.data.dynamic.status)
                    setMultiSelectValue('type', retObj.data.dynamic.type)
//                $('#expected_salary').val(retObj.data.static.expected_salary)
//                $('#daily_salary').val(retObj.data.static.daily_salary)
                    $('#arrival_time').val(retObj.data.dynamic.arrival_time)
                    $('#emergency').val(retObj.data.dynamic.emergency)
                    $('#relationship').val(retObj.data.dynamic.relationship)
                    $('#linkman_tel').val(retObj.data.dynamic.linkman_tel)
                    $('#remark').val(retObj.data.dynamic.remark)
                }
            })
        }
    })
</script>

<div id="address"></div>
<div class="container" style="background-color: #FFF"><!-- 右侧开始 -->
    <div class="content-wrapper">
        <form class="form-inline" data-toggle="validator">
            <h5 class="form-title">工作信息</h5>

            <div class="form-group">
                <label for="service_range" class="text-indent">求职意向：</label>

                <div class="add-list checkbox" id="service_range">
                    <label>
                        <input type="checkbox" value="1"> 临时钟点工
                    </label>
                    <label>
                        <input type="checkbox" value="2"> 长期钟点工
                    </label>
                    <label>
                        <input type="checkbox" value="3"> 保姆
                    </label>
                    <label>
                        <input type="checkbox" value="4"> 育儿嫂
                    </label>
                    <label>
                        <input type="checkbox" value="5"> 疾病护理
                    </label>
                    <label>
                        <input type="checkbox" value="6"> 老人护理
                    </label>
                    <label>
                        <input type="checkbox" value="7"> 月嫂
                    </label>
                    <label>
                        <input type="checkbox" value="8"> 早教
                    </label>
                    <label>
                        <input type="checkbox" value="9"> 催乳师
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="status" class="text-indent">状态：</label>

                <div class="radio-group" id="status">
                    <label class="radio">
                        <input type="radio" name="status" value="0"> 待岗
                    </label>
                    <label class="radio">
                        <input type="radio" name="status" value="1"> 在职
                    </label>
                    <label class="radio">
                        <input type="radio" name="status" value="2"> 可兼职
                    </label>
                    <label class="radio">
                        <input type="radio" name="status" value="4"> 外派中
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label for="type" class="text-indent">类别：</label>

                <div class="radio-group" id="type">
                    <label class="radio">
                        <input type="radio" name="type" id="inHome" value="1">
                        住家
                    </label>
                    <label class="radio">
                        <input type="radio" name="type" id="notInHome" value="0">
                        不住家
                    </label>
                </div>
            </div>

            <div>
                <label>服务区域：</label>
            </div>

            <div class="form-group">
                <label for="">可到岗时间：</label>
                <input type="text" class="form-control" value="" id="arrival_time">
            </div>
            <div class="form-group">
                <label for="">紧急联系人：</label>
                <input type="text" class="form-control" value="" id="emergency">
            </div>
            <div class="form-group">
                <label for="">与本人关系：</label>
                <input type="text" class="form-control" value="" id="relationship">
            </div>
            <div class="form-group">
                <label for="">联系电话：</label>
                <input type="text" class="form-control" value="" id="linkman_tel">
            </div>
            <label for="">特别说明：</label>
            <textarea class="form-control" id="remark"></textarea>
        </form>
        <div class="form-footer float-right">
            <button type="button" class="btn-none" data-dismiss="modal">放弃</button>

            <button id="message_trigger_ok" type="button" class="btn-green-big">下一步</button>
        </div>
    </div>
    <!-- container end -->
</div>
</section>

<script src="js/jquery-2.0.2.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/sco.message.js"></script>
<script src="js/jquery.bootstrap-autohidingnavbar.js"></script>
</body>
<script type="text/javascript">
    function pageScroll() {
        parent.window.scrollBy(0, -100);
        scrolldelay = setTimeout('pageScroll()', 100);
        var sTop = parent.document.documentElement.scrollTop + parent.document.body.scrollTop;
        if (sTop == 0) {
            clearTimeout(scrolldelay);
            window.setTimeout(function () {
                parent.document.getElementById("rightContent").setAttribute("src", "shop.html")
            }, 500);
            ;
        }
        ;
    }
    $('#message_trigger_ok').on('click', function (e) {
        e.preventDefault();
//        $.scojs_message('添加成功', $.scojs_message.TYPE_OK);
//        pageScroll();
        var employId = getQueryString('employeeId')
        var paramObj = {};
        paramObj.status = getMultiSelectValue('status');
        paramObj.employee_id = employId;
        paramObj.service_range = getMultiSelectValue('service_range');
        paramObj.emergency = $('#emergency').val();
        paramObj.relationship = $('#relationship').val();
        paramObj.linkman_tel = $('#linkman_tel').val();
        paramObj.arrival_time = $('#arrival_time').val();
        paramObj.remark = $('#remark').val();


        var postUrl = '';
        if (isUpdate == 'true') {
            postUrl = "http://test.fuhui.com/employeeShop/update";
        } else {
            postUrl = "http://test.fuhui.com/employeeShop/add";
        }
        $.ajax({
            url: postUrl,
            type: 'POST',
            data: paramObj,
            success: function (ret) {
//                parent.document.getElementById("rightContent").setAttribute("src", "addAunt-Certificate.html");
//                $.scojs_message('添加成功', $.scojs_message.TYPE_OK);
                var retObj = JSON.parse(ret);
                if (retObj.code == '0') {
                    parent.document.getElementById("rightContent").setAttribute("src", "addAunt-Certificate.html?employee_id="+employId);
                } else if (retObj.code == '12064') {
                    alert('本门店已经添加过此阿姨')
                } else {
                    alert('添加失败')
                }
            },
            error: function (ret) {
                alert('error')
            }
        })
    });


    $('#message_trigger_err').on('click', function (e) {
        e.preventDefault();
        $.scojs_message('添加失败', $.scojs_message.TYPE_ERROR);
    });
</script>
</html>

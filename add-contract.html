<html>
<header>
	<script src="js/allBiz.js"></script>
	<link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">
	<script src="js/bootstrap-datetimepicker.js"></script>
	<script src="js/paramMap.js"></script>
</header>
<body>

<div class="container" style="background-color: #FFF"><!-- 右侧开始 -->
				<div class="content-wrapper">
					<div class="content-header-inner">
					<div class="bread-nav float-left">
						<ol class="breadcrumb">
							<li><a href="client.html"></a>新增合同</li>
						</ol>
					</div>				
				</div>
					<div class="form-dialog">
						<div class="form-content clearfix">     
   							<div class="form-body">
   								<div class="modal-body-wrapper">
									<form class="form-inline">
										
										<div class="form-group">
										  <label for="eename">合同类型：</label>
										    <input type="text" class="form-control" id="type" readonly>
										</div>
										<div class="form-group">
										  <label for="userName">客户姓名：</label>
										    <input type="text" class="form-control" id="userName" readonly>
										</div>
										<div class="form-group">
										  <label for="eename">阿姨姓名：</label>
										    <input type="text" class="form-control" id="eename" readonly>
										</div>
										<div class="form-group">
										    <label for="create">签订日期：</label>
										    <input type="text" class="form-control datetimepicker" id="create" value="">
										</div>
										<div class="form-group">
										    <label for="start">合同开始：</label>
												<input type="text" class="form-control datetimepicker" id="start" value="">
									    </div>
									    <div class="form-group">
										    <label for="end">合同结束：</label>
												<input type="text" class="form-control datetimepicker" id="end" value="">
									    </div>
									 
										<div class="form-group">
										   
										   <label for="payMoney">合同工资：</label>
										    <input id="payMoney" type="text" class="form-control form-control-2x " value="" > 元
												<select id="payType" class="form-control"><option value="0">月</option><option value="1">小时</option></select>
										 </div>

										<div class="form-group">
										   
										   <label for="eePay">阿姨中介费：</label>
										    <input type="text" class="form-control" id="eePay"><span class="input-span">元</span>
										    </div>
									 
										<div class="form-group">
										    <label for="ePay">客户中介费：</label>
										    <input type="text" class="form-control" id="ePay"><span class="input-span">元</span>
										</div>

										<!--<div class="form-group">-->
										    <!--<label for="sPay">友店中介费：</label>-->
										    <!--<input type="text" class="form-control" id="sPay"><span class="input-span">元</span>-->
										<!--</div>-->
									
									<div class="form-group">
									    <label for="remark">备注：</label>
									    <textarea class="form-control" id="remark"></textarea>
									    
									  </div>
									  	</form>

						      </div>
						     </div>


						      <div class="form-footer float-right">
						      
						      	<button type="button" class="btn-none" data-toggle="modal" data-target=".bs-example-modal-sm">放弃</button>
						        <button id="message_trigger_ok" type="button" class="btn-green-big">保存</button>
						       
						      </div>
						    </div>
						    
						<!-- Modal -->
							<div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
							  <div class="modal-dialog modal-sm">
							    <div class="modal-content">
							      <div class="modal-header">
							        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							        <h4 class="modal-title" id="myModalLabel">放弃添加</h4>
							      </div>
							      <div class="modal-body">
							        您确定放弃当前添加？
							      </div>
							      <div class="modal-footer">
							        <button type="button" class="btn btn-default" data-dismiss="modal" onClick="location.href='order-service.html'">取消</button>
							        <button type="button" class="btn btn-primary">放弃</button>
							      </div>
							    </div>
							  </div>
							</div>
					</div>	
			</div><!-- container end -->
		</div>
	</section>

	<script src="js/jquery-2.0.2.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/bootstrap-datetimepicker.js"></script>
	<script src="js/sco.message.js"></script>
	<script src="js/jquery.bootstrap-autohidingnavbar.js"></script>
</body>
<script type="text/javascript">
	$(function(){
		var contract_needed_data = store('contract_needed_data');
		$('#userName').val(contract_needed_data.userName);
		$('#eename').val(contract_needed_data.eename);
		$('#type').val(contract_needed_data.type);

		$('#message_trigger_ok').on('click', function () {
			var paramObj = {};
			paramObj.type = getQueryString('type');
			paramObj.status = getQueryString('status');
			paramObj.oid = getQueryString('oid');
			paramObj.eid = getQueryString('eid');
			paramObj.eeid = getQueryString('eeid');
			paramObj.eename = $('#eename').val();
			paramObj.userName = $('#userName').val();
			paramObj.create = $('#create').val();
			paramObj.start = $('#start').val();
			paramObj.end = $('#end').val();
			paramObj.payType = $('#payType').val();
			paramObj.payMoney = $('#payMoney').val();
			paramObj.ePay = $('#ePay').val();
			paramObj.eePay = $('#eePay').val();
			paramObj.remark = $('#remark').val();
			$.ajax({
				url: "http://test.fuhui.com/contracts/add",
				type: 'POST',
				data: paramObj,
				success: function (ret) {
					var retObj = JSON.parse(ret);
					if (retObj.code == '0') {
						$.scojs_message('合同签订成功', $.scojs_message.TYPE_OK);
						$.ajax({
							url: "http://test.fuhui.com/bill/update",
							type: 'POST',
							data: {
								id: retObj.data.order_id,
								cid: retObj.data.cid
							},
							success: function (ret) {
								var retObj = JSON.parse(ret);
								if (retObj.code == '0') {
									setTimeout(function(){
									  parent.document.getElementById("rightContent").setAttribute("src", "order-service.html?orderId=" + getQueryString('did'));
									},1e3);
								} else{
									window.location.reload();
								}
							}
						});
					} else{
						$.scojs_message(errorCode['code_' + retObj.code], $.scojs_message.TYPE_ERROR);
					}
				},
				error: function (ret) {
					$.scojs_message('合同签订失败', $.scojs_message.TYPE_ERROR)
				}
			});
		});
	});
   $('.datetimepicker').datetimepicker({
	   autoclose: true,
    	format: 'yyyy-mm-dd hh:ii'
});
</script>  
</html>
